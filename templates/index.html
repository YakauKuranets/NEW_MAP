<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="csrf-token" content="{{ csrf_token() }}">
  <script src="{{ url_for('static', filename='js/csrf.js') }}"></script>
  <script src="{{ url_for('static', filename='js/realtime.js') }}"></script>
  <script src="{{ url_for('static', filename='js/i18n.js') }}"></script>
  <title data-i18n="map_title">Map v12 ‚Äî –æ–Ω–ª–∞–π–Ω + –æ—Ñ–ª–∞–π–Ω</title>

  <!-- Leaflet / –ø–ª–∞–≥–∏–Ω—ã -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-draw@1.0.4/dist/leaflet.draw.css"/>

  <!-- –ò–∫–æ–Ω–∫–∏ -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

  <style>
    html,body{height:100%;margin:0}
    #map{position:absolute;top:var(--top,56px);left:var(--side,320px);right:0;bottom:0}
  </style>
</head>
<body class="light">
  <div class="topbar">
    <button id="btn-toggle-sidebar" class="icon" title="–°–∫—Ä—ã—Ç—å/–ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫">‚ò∞</button>
    <div class="brand">Map v12</div>

    <input id="search" class="input" placeholder="–ü–æ–∏—Å–∫‚Ä¶" data-i18n-placeholder="map_search_ph">
    <ul id="search-suggestions" class="suggestions"></ul>

    <select id="filter-category" class="input">
      <option value="" data-i18n="map_cat_all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
      <option value="–í–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ" data-i18n="map_cat_video">–í–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ</option>
      <option value="–î–æ–º–æ—Ñ–æ–Ω" data-i18n="map_cat_dom">–î–æ–º–æ—Ñ–æ–Ω</option>
      <option value="–®–ª–∞–≥–±–∞—É–º" data-i18n="map_cat_slag">–®–ª–∞–≥–±–∞—É–º</option>
    </select>

    <button id="btn-access" class="btn" title="–¢–∏–ø –¥–æ—Å—Ç—É–ø–∞" data-i18n="map_access_btn" data-i18n-title="map_access_btn">–¢–∏–ø –¥–æ—Å—Ç—É–ø–∞</button>
    <div id="access-menu" class="dropdown-menu">
      <label class="dropdown-item"><input type="checkbox" id="opt-local"> <span data-i18n="map_status_local">–õ–æ–∫–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø</span></label>
      <label class="dropdown-item"><input type="checkbox" id="opt-remote"> <span data-i18n="map_status_remote">–£–¥–∞–ª–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø</span></label>
    </div>

    <div class="top-actions">
      <button id="btn-theme" class="btn" title="–¢–µ–º–∞" data-i18n-title="common_theme">üåì</button>
      <button id="btn-lang" class="btn" title="–Ø–∑—ã–∫" data-i18n-title="common_language">RU</button>

      <button id="btn-add" class="btn primary" title="–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å">
        <i class="fa-solid fa-plus"></i> <span class="lbl" data-i18n="map_btn_add">–î–æ–±–∞–≤–∏—Ç—å</span>
      </button>

      <button id="btn-file" class="btn" title="–ò–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö">
        <i class="fa-solid fa-file-lines"></i> <span class="lbl" data-i18n="map_btn_data">–î–∞–Ω–Ω—ã–µ</span>
      </button>
      <div id="file-menu" class="dropdown-menu">
        <button id="menu-export-csv" class="dropdown-item"><i class="fa-solid fa-file-arrow-down"></i> –°–∫–∞—á–∞—Ç—å CSV</button>
        <button id="menu-export-json" class="dropdown-item"><i class="fa-solid fa-file-code"></i> –°–∫–∞—á–∞—Ç—å JSON</button>
        <button id="menu-export-xlsx" class="dropdown-item"><i class="fa-solid fa-file-excel"></i> –°–∫–∞—á–∞—Ç—å –æ—Ç—á—ë—Ç Excel</button>
        <button id="menu-export-addresses-xlsx" class="dropdown-item"><i class="fa-solid fa-file-excel"></i> –°–∫–∞—á–∞—Ç—å –∞–¥—Ä–µ—Å–∞ Excel</button>
        <button id="menu-import-csv" class="dropdown-item"><i class="fa-solid fa-file-arrow-up"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å CSV</button>
        <button id="menu-import-json" class="dropdown-item"><i class="fa-solid fa-file-import"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å JSON</button>
      
        
<label class="theme-toggle">
  <input type="checkbox" id="theme-toggle-checkbox">
  –¢—ë–º–Ω–∞—è —Ç–µ–º–∞
</label></div>

      <button id="btn-bulk-del" class="btn warn" title="–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏" disabled>
        <i class="fa-solid fa-trash"></i> <span class="lbl" data-i18n="map_btn_delete_selected">–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–µ</span>
      </button>

      <button id="btnDrawZone" class="btn outline" title="–ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å –∑–æ–Ω—É">
        <i class="fa-solid fa-draw-polygon"></i> <span class="lbl">–ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å –∑–æ–Ω—É</span>
      </button>
      <button id="btnChooseIcon" class="btn outline" title="–í—ã–±—Ä–∞—Ç—å –∑–Ω–∞—á–æ–∫ –∑–æ–Ω—ã">
        <i class="fa-solid fa-icons"></i> <span class="lbl">–í—ã–±–æ—Ä –∑–Ω–∞—á–∫–∞</span>
      </button>

      <button id="btn-help" class="btn outline" title="–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è">
        <i class="fa-solid fa-circle-question"></i> <span class="lbl">–ü–æ–º–æ—â—å</span>
      </button>

      <div class="notif-wrap">
        <button id="btn-bell" class="btn" title="–í—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã">
          <i class="fa-solid fa-bell"></i>
          <span id="notif-count" class="notif-badge hidden">0</span>
        </button>
        <div id="notif-menu" class="dropdown-menu notif-menu">
          <div class="notif-head"><span>–í—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã</span><span id="requests-react-root"></span></div>
          <ul id="notif-list" class="notif-list"></ul>
          <div class="notif-empty hidden">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø—Ä–æ—Å–æ–≤</div>
        </div>
      </div>

      <!-- –ö–Ω–æ–ø–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (–¥–∞—à–±–æ—Ä–¥, —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞) -->
      <button id="btn-analytics" class="btn" title="–ê–Ω–∞–ª–∏—Ç–∏–∫–∞" style="display:none">
        <i class="fa-solid fa-chart-column"></i>
      </button>
      <!-- –ö–Ω–æ–ø–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–æ–Ω–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞) -->
      <button id="btn-zones" class="btn" title="–ó–æ–Ω—ã" style="display:none">
        <i class="fa-solid fa-draw-polygon"></i>
      </button>

      <!-- –ö–Ω–æ–ø–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å—É–ø–µ—Ä‚Äë–∞–¥–º–∏–Ω–∞) -->
      <button id="btn-admin-users" class="btn" title="–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã" style="display:none">
        <i class="fa-solid fa-user-shield"></i>
      </button>

      <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —á–∞—Ç–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞) -->
      <button id="btn-chat" class="btn" title="–ß–∞—Ç" style="display:none">
        <i class="fa-solid fa-comments"></i>
      </button>

      <!-- –°–ª–æ–π –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞) -->
      <button id="btn-incidents-layer" class="btn" title="–ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã –Ω–∞ –∫–∞—Ä—Ç–µ" style="display:none" aria-pressed="false">
        <i class="fa-solid fa-triangle-exclamation"></i>
        <span class="lbl">–ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã</span>
      </button>
      <!-- –≠—Ç–∞–ø 2: —Å–ª–æ–π –æ–±—ä–µ–∫—Ç–æ–≤ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ -->
      <button id="btn-objects-layer" class="btn" title="–û–±—ä–µ–∫—Ç—ã –Ω–∞ –∫–∞—Ä—Ç–µ" style="display:none" aria-pressed="false">
        <i class="fa-solid fa-location-dot"></i>
        <span class="lbl">–û–±—ä–µ–∫—Ç—ã</span>
      </button>
      <button id="btn-object-add" class="btn" title="–°–æ–∑–¥–∞—Ç—å –∏–Ω—Ü–∏–¥–µ–Ω—Ç –Ω–∞ –∫–∞—Ä—Ç–µ" style="display:none" data-mode="incident">
        <i class="fa-solid fa-plus"></i>
        <span class="lbl">–ò–Ω—Ü–∏–¥–µ–Ω—Ç</span>
      </button>
      <button id="btn-admin-panel" class="btn" title="–ö–æ–º–∞–Ω–¥–Ω—ã–π —Ü–µ–Ω—Ç—Ä" style="display:none">
        <i class="fa-solid fa-display"></i>
      </button>
      <span id="chat-react-root" class="top-chat-indicator"></span>
      <div id="admin-info" class="admin-info">
        <span id="admin-info-label" class="admin-info__label"></span>
        <span id="admin-role-badge" class="admin-role-badge" style="display:none"></span>
      </div>
    </div>

    <button id="scroll-left" class="scroll-btn"><i class="fa-solid fa-chevron-left"></i></button>
    <button id="scroll-right" class="scroll-btn"><i class="fa-solid fa-chevron-right"></i></button>
  </div>

  <div id="sidebar">
    <div class="list-head">
      <span>–í—Å–µ –∞–¥—Ä–µ—Å–∞</span>

      <!-- –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–æ—Ç–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –º–µ—Ç–∫–∏ -->
      <div class="list-head-actions">
        <button id="btn-view-photo" class="btn outline" title="–ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ç–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –º–µ—Ç–∫–∏">
          <i class="fa-solid fa-image"></i>
        </button>
      </div>

      <span id="count">0</span>
    </div>
    <div id="drop-hint">–ü–µ—Ä–µ—Ç–∞—â–∏ CSV —Å—é–¥–∞ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞</div>
    <div id="summary-panel" class="summary-panel"></div>
    <div id="current-filter" class="muted" style="padding:4px 12px 4px 12px;font-size:0.85rem;"><span data-i18n="map_filter_lbl">–§–∏–ª—å—Ç—Ä:</span> <span id="current-filter-val" data-i18n="map_filter_all">–≤—Å–µ –∞–¥—Ä–µ—Å–∞</span></div>
    <div id="filter-summary" class="muted" style="padding:0 12px 6px 12px;font-size:0.8rem;"><span data-i18n="map_total_lbl">–ê–¥—Ä–µ—Å–æ–≤:</span> <span id="filter-summary-count">0</span> <span id="filter-summary-extra" class="muted"></span></div>
    <div id="analytics-react-root" class="panel-card" style="margin:0 10px 8px 10px;"></div>
    <div id="list"></div>
  </div>

  <div id="map"></div>

  <div class="fab"><button id="btn-settings" title="–û—Ñ–ª–∞–π–Ω">‚öôÔ∏è</button></div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
  <div id="modal-backdrop" class="backdrop">
    <div class="modal">
      <div class="modal-head">
        <b id="modal-title">–î–æ–±–∞–≤–∏—Ç—å</b>
        <button id="modal-close" class="btn minimal" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="section muted small">
          –ü–æ—Å—Ç–∞—Ä–∞–π—Å—è –∑–∞–ø–æ–ª–Ω—è—Ç—å –∞–¥—Ä–µ—Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–Ω—è—Ç–Ω–æ: —É–ª–∏—Ü–∞, –¥–æ–º, –æ—Ä–∏–µ–Ω—Ç–∏—Ä.
          –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–æ –∫–Ω–æ–ø–∫–µ ¬´–ì–µ–æ–∫–æ–¥–∏–Ω–≥¬ª –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–¥–ø—Ä–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é.
        </div>
        <div class="row2">
          <input id="f-address" placeholder="–ê–¥—Ä–µ—Å" maxlength="255" autocomplete="off">
          <button id="btn-geocode" class="btn" type="button">–ì–µ–æ–∫–æ–¥–∏–Ω–≥</button>
        </div>
        <div class="row2">
          <input id="f-lat" placeholder="–®–∏—Ä–æ—Ç–∞" inputmode="decimal">
          <input id="f-lon" placeholder="–î–æ–ª–≥–æ—Ç–∞" inputmode="decimal">
        </div>
        <textarea id="f-desc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" maxlength="500"></textarea>
        <input id="f-link" placeholder="–°—Å—ã–ª–∫–∞ (–ø–æ –∂–µ–ª–∞–Ω–∏—é)" maxlength="255" inputmode="url">
        <select id="f-status">
          <option>–õ–æ–∫–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø</option>
          <option>–£–¥–∞–ª–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø</option>
        </select>
        <select id="f-category">
          <option>–í–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ</option>
          <option>–î–æ–º–æ—Ñ–æ–Ω</option>
          <option>–®–ª–∞–≥–±–∞—É–º</option>
        </select>

        <!-- –ü–æ–ª–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) -->
        <input id="f-photo" type="file" accept="image/*" style="margin-top:8px"/>

        <!-- –î–µ–π—Å—Ç–≤–∏—è —Å —É–∂–µ –ø—Ä–∏–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã–º —Ñ–æ—Ç–æ (–¥–ª—è —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è) -->
        <div id="photo-edit-actions" class="row2" style="margin-top:8px; display:none">
          <button id="btn-delete-photo" class="btn warn" type="button">
            <i class="fa-solid fa-trash"></i><span class="lbl">–£–¥–∞–ª–∏—Ç—å —Ñ–æ—Ç–æ</span>
          </button>
        </div>

        <!-- —Å–∫—Ä—ã—Ç—ã–π —Ñ–ª–∞–≥: 1 = —É–¥–∞–ª–∏—Ç—å —Ñ–æ—Ç–æ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ -->
        <input id="f-remove-photo" type="hidden" value="0">
      </div>
      <div class="modal-foot">
        <button id="modal-save" class="btn primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- –≠—Ç–∞–ø 2: –º–æ–¥–∞–ª–∫–∞ ¬´–û–±—ä–µ–∫—Ç¬ª (–∞–¥—Ä–µ—Å + –æ–ø–∏—Å–∞–Ω–∏–µ + –∫–∞–º–µ—Ä—ã) -->
    <div id="incident-backdrop" class="backdrop" style="display:none">
      <div class="modal" style="width:min(620px,96vw)">
        <div class="modal-head">
          <b id="incident-modal-title">–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ü–∏–¥–µ–Ω—Ç</b>
          <button id="incident-modal-close" class="btn minimal" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
        </div>
        <div class="modal-body">
          <div>
            <label class="muted small">–ê–¥—Ä–µ—Å</label>
            <div style="display:flex; gap:8px; align-items:center">
              <input id="inc-address" class="input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —É–ª. –õ–µ–Ω–∏–Ω–∞ 10" style="flex:1" />
              <button id="inc-geocode" class="btn" type="button" title="–ù–∞–π—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ –∞–¥—Ä–µ—Å—É">–ù–∞–π—Ç–∏</button>
            </div>
          </div>

          <input id="inc-lat" type="hidden" />
          <input id="inc-lon" type="hidden" />

          <div style="margin-top: 10px">
            <label class="muted small">–û–ø–∏—Å–∞–Ω–∏–µ</label>
            <textarea id="inc-desc" class="input" rows="3" placeholder="–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ / —á—Ç–æ –≤–∞–∂–Ω–æ"></textarea>
          </div>

          <div class="actions" style="margin-top: 14px; display:flex; justify-content:space-between; gap:8px; flex-wrap:wrap">
            <div class="muted small" style="display:flex; align-items:center">
              –ü–æ–¥—Å–∫–∞–∑–∫–∞: –Ω–∞–∂–º–∏—Ç–µ ¬´–ò–Ω—Ü–∏–¥–µ–Ω—Ç¬ª, –∑–∞—Ç–µ–º –∫–ª–∏–∫ –ø–æ –∫–∞—Ä—Ç–µ. –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –±–µ—Ä—É—Ç—Å—è –∏–∑ —Ç–æ—á–∫–∏, –Ω–µ –∏–∑ —Ü–µ–Ω—Ç—Ä–∞.
            </div>
            <div style="display:flex; gap:8px; margin-left:auto">
              <button id="inc-cancel" class="btn" type="button">–û—Ç–º–µ–Ω–∞</button>
              <button id="inc-save" class="btn primary" type="button">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
          </div>

        </div>
      </div>
    </div>

  <div id="object-backdrop" class="backdrop">
    <div class="modal" style="width:min(860px,96vw)">
      <div class="modal-head">
        <b id="object-modal-title">–û–±—ä–µ–∫—Ç</b>
        <button id="object-modal-close" class="btn minimal" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="grid" style="grid-template-columns: 1.2fr 0.8fr 0.8fr; gap: 8px; align-items:end">
          <div>
            <label class="muted small">–ê–¥—Ä–µ—Å/–Ω–∞–∑–≤–∞–Ω–∏–µ</label>
            <div style="display:flex; gap:8px; align-items:center">
              <input id="obj-name" class="input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —É–ª. –õ–µ–Ω–∏–Ω–∞ 10" style="flex:1" />
              <button id="obj-geocode" class="btn" type="button" title="–ù–∞–π—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ –∞–¥—Ä–µ—Å—É">–ù–∞–π—Ç–∏</button>
            </div>
          </div>
          <div>
            <label class="muted small">Lat</label>
            <input id="obj-lat" class="input" placeholder="53.900000" />
          </div>
          <div>
            <label class="muted small">Lon</label>
            <input id="obj-lon" class="input" placeholder="27.566667" />
          </div>
        </div>

        <div class="grid" style="grid-template-columns: 1fr; gap: 8px; margin-top: 10px">
          <div>
            <label class="muted small">–û–ø–∏—Å–∞–Ω–∏–µ</label>
            <textarea id="obj-desc" class="input" rows="3" placeholder="–ö–æ—Ä–æ—Ç–∫–æ: —á—Ç–æ –∑–¥–µ—Å—å –∏ —á—Ç–æ –≤–∞–∂–Ω–æ"></textarea>
          </div>
          <div>
            <label class="muted small">–¢–µ–≥–∏/–∫–∞—Ç–µ–≥–æ—Ä–∏—è</label>
            <input id="obj-tags" class="input" placeholder="–í–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ, –î–æ–º–æ—Ñ–æ–Ω, ..." />
          </div>
        </div>

        <div style="margin-top: 12px">
          <div style="display:flex; align-items:center; justify-content:space-between; gap:10px">
            <b>–ö–∞–º–µ—Ä—ã</b>
            <button id="obj-add-cam" class="btn" type="button" title="–î–æ–±–∞–≤–∏—Ç—å –∫–∞–º–µ—Ä—É">+ –ö–∞–º–µ—Ä–∞</button>
          </div>
          <div class="muted small" style="margin-top:4px">URL –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω. Label –∏ type –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã.</div>
          <div id="obj-cameras" style="display:flex; flex-direction:column; gap:6px; margin-top:8px"></div>
        </div>

        <div class="actions" style="margin-top: 14px; display:flex; justify-content:space-between; gap:8px; flex-wrap:wrap">
          <button id="obj-delete" class="btn warn" type="button" style="display:none">–£–¥–∞–ª–∏—Ç—å</button>
          <div style="display:flex; gap:8px; margin-left:auto">
            <button id="obj-save" class="btn primary" type="button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–∏–∫—Ä–µ–ø–ª—ë–Ω–Ω–æ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ -->
  <div id="photo-backdrop" class="backdrop" style="display:none">
    <div class="modal photo">
      <div class="modal-head">
        <b>–§–æ—Ç–æ –º–µ—Ç–∫–∏</b>
        <button id="photo-close" class="btn minimal" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
      <div class="modal-body" style="text-align:center">
        <img id="photo-img" src="" alt="–§–æ—Ç–æ" style="max-width:100%;height:auto;border-radius:8px">
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ —á–∞—Ç–∞ -->
  <div id="chat-backdrop" class="backdrop">
    <div class="modal chat">
      <div class="modal-head">
        <b>–ß–∞—Ç</b>
        <button id="chat-close" class="btn minimal" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
      <div class="modal-body chat-body">
        <div class="chat-list">
          <div class="chat-list-controls">
            <input id="chat-search" class="input chat-search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∏–∫—É –∏–ª–∏ ID">
            <label class="chat-unread-only">
              <input type="checkbox" id="chat-only-unread">
              –¢–æ–ª—å–∫–æ —Å –Ω–æ–≤—ã–º–∏
            </label>
          </div>
          <div class="chat-list-body"></div>
        </div>
        <div class="chat-dialog">
          <div class="chat-dialog-head">
            <div class="chat-peer">
              <span id="chat-peer-name" class="chat-username muted">–í—ã–±–µ—Ä–∏—Ç–µ –¥–∏–∞–ª–æ–≥ —Å–ª–µ–≤–∞</span>
              <span id="chat-peer-id" class="chat-peer-id muted"></span>
            </div>
            <div class="chat-status-wrap">
              <label class="chat-status-label muted">
                –°—Ç–∞—Ç—É—Å:
                <select id="chat-status" class="chat-status-select">
                  <option value="new">–ù–æ–≤—ã–π</option>
                  <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                  <option value="closed">–ó–∞–∫—Ä—ã—Ç</option>
                </select>
              </label>
            </div>
            <button id="chat-clear" class="btn minimal" type="button" title="–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –¥–∏–∞–ª–æ–≥–∞">üóë</button>
          </div>
          <div class="chat-messages"></div>
          <div class="chat-input">
            <input id="chat-input-field" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ‚Ä¶" class="input">
            <button id="chat-send" class="btn primary" type="button">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
          </div>
        </div>
      </div>
    </div>
  </div>

    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ñ–ª–∞–π–Ω–∞ (—à–µ—Å—Ç–µ—Ä—ë–Ω–∫–∞) -->
  <div id="settings-backdrop" class="backdrop">
    <div class="modal settings">
      <div class="modal-head">
        <b>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ / –æ—Ñ–ª–∞–π–Ω</b>
        <button id="settings-close" class="btn minimal" type="button" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
      <div class="modal-body">

        <div class="section">
          <h4>–ì–æ—Ä–æ–¥ / –Ω–∞–±–æ—Ä –∫–∞—Ä—Ç—ã</h4>
          <select id="offline-city" class="input"></select>
        </div>

        <div class="section">
          <h4>–†–µ–∂–∏–º –∫–∞—Ä—Ç—ã</h4>
          <select id="map-mode" class="input">
            <option value="online">–û–Ω–ª–∞–π–Ω</option>
            <option value="offline">–û—Ñ–ª–∞–π–Ω</option>
          </select>
        </div>

        <div class="section">
          <h4>–¢–µ–º–∞</h4>
          <select id="theme-select" class="input">
            <option value="">–§–∏–æ–ª–µ—Ç–æ–≤–∞—è</option>
            <option value="blue">–°–∏–Ω—è—è</option>
          </select>
        </div>

        <div class="section">
          <h4>–û—Ñ–ª–∞–π–Ω-–∫–∞—Ä—Ç–∞</h4>
          <div class="row" style="display:flex;align-items:center;gap:8px">
            <label for="offline-zmax" class="muted" style="white-space:nowrap">–ú–∞–∫—Å. –∑—É–º:</label>
            <input id="offline-zmax" type="number" class="input" value="14" min="0" max="19" style="width:80px">
          </div>
          <div class="row" style="display:flex;align-items:center;gap:8px;margin-top:8px">
            <button id="btn-download-map" class="btn primary" type="button">–°–∫–∞—á–∞—Ç—å –∫–∞—Ä—Ç—É</button>
            <div class="progress-wrap">
              <div class="progress" id="map-progress"><span>0%</span></div>
            </div>
          </div>
          <div class="row" style="display:flex;align-items:center;gap:8px;margin-top:4px">
            <button id="btn-delete-map" class="btn warn" type="button">–£–¥–∞–ª–∏—Ç—å –∫–∞—Ä—Ç—É</button>
            <span id="map-status" class="muted"></span>
          </div>
        </div>

        <div class="section">
          <h4>–ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ</h4>
          <div class="row" style="display:flex;align-items:center;gap:8px">
            <button id="btn-download-geocode" class="btn" type="button">–°–∫–∞—á–∞—Ç—å –±–∞–∑—É –∞–¥—Ä–µ—Å–æ–≤</button>
            <div class="progress-wrap">
              <div class="progress" id="geo-progress"><span>0%</span></div>
            </div>
          </div>
          <div class="row" style="display:flex;align-items:center;gap:8px;margin-top:4px">
            <button id="btn-delete-geocode" class="btn warn" type="button">–£–¥–∞–ª–∏—Ç—å –±–∞–∑—É</button>
            <span id="geo-status" class="muted"></span>
          </div>
        </div>

        <div class="section">
          <h4>–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–∫–∞—á–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h4>
          <div class="row" style="display:flex;gap:8px;margin-bottom:8px">
            <button id="btn-view-map-files" class="btn" type="button">–§–∞–π–ª—ã –∫–∞—Ä—Ç—ã</button>
            <button id="btn-view-geocode-files" class="btn" type="button">–§–∞–π–ª—ã –≥–µ–æ–∫–æ–¥–µ—Ä–∞</button>
          </div>
          <div id="map-files-list" class="file-list" style="display:none"></div>
          <div id="geocode-files-list" class="file-list" style="display:none"></div>
        </div>

        <div class="section">
          <h4>–ù–∞–±–æ—Ä—ã –æ—Ñ–ª–∞–π–Ω-–∫–∞—Ä—Ç</h4>
          <select id="offline-set-select" class="input" style="width:100%;margin-bottom:8px"></select>
          <div class="row" style="display:flex;gap:8px;margin-top:4px">
            <button id="btn-activate-set" class="btn primary" type="button">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
            <button id="btn-delete-set" class="btn warn" type="button">–£–¥–∞–ª–∏—Ç—å</button>
          </div>
        </div>

        <div class="section">
          <h4>–ó–∞–ø–∏—Å–∏ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è</h4>
          <button id="btn-view-geocode-entries" class="btn" type="button" style="margin-bottom:8px">–ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–ø–∏—Å–∏</button>
          <div id="geocode-entries-list" class="entry-list" style="display:none"></div>
        </div>

      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ -->
  <div id="analytics-backdrop" class="backdrop">
    <div class="modal analytics">
      <div class="modal-head">
        <b>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</b>
        <button id="analytics-close" class="btn minimal" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="section">
          <div class="muted">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥:</div>
          <div id="analytics-periods" class="analytics-periods" style="margin-top:8px;">
            <button class="btn outline analytics-period-btn" data-days="1" type="button">1 –¥–µ–Ω—å</button>
            <button class="btn outline analytics-period-btn" data-days="7" type="button">–ù–µ–¥–µ–ª—è</button>
            <button class="btn outline analytics-period-btn" data-days="30" type="button">–ú–µ—Å—è—Ü</button>
            <button class="btn outline analytics-period-btn" data-days="90" type="button">–ö–≤–∞—Ä—Ç–∞–ª</button>
            <button class="btn outline analytics-period-btn" data-days="182" type="button">–ü–æ–ª–≥–æ–¥–∞</button>
            <button class="btn outline analytics-period-btn" data-days="365" type="button">–ì–æ–¥</button>
          </div>
        </div>

        <div id="analytics-text" class="analytics-text muted">
          –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –ø–µ—Ä–∏–æ–¥–∞, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–¥–∫—É.
        </div>
      </div>
    </div>
  </div>


  <!-- –ú–æ–¥–∞–ª–∫–∞ –∑–æ–Ω -->
  <div id="zone-backdrop">
    <div class="zone-modal">
      <div class="zone-modal__header">–ó–æ–Ω–∞</div>
      <div class="zone-modal__body">
        <label class="zlabel">–û–ø–∏—Å–∞–Ω–∏–µ</label>
        <input type="text" id="zoneDesc" class="zinput" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∑–æ–Ω—ã">

        <label class="zlabel">–¶–≤–µ—Ç</label>
        <input type="color" id="zoneColor" class="zinput" value="#ffcc00">

        <label class="zlabel">–ó–Ω–∞—á–æ–∫</label>
        <div class="zone-icons" id="zoneIcons">
          <div class="zicon active" data-icon="beer">üç∫</div>
          <div class="zicon" data-icon="car-crash">üöóüí•</div>
          <div class="zicon" data-icon="user-secret">üïµÔ∏è</div>
          <div class="zicon" data-icon="gavel">‚öñÔ∏è</div>
          <div class="zicon" data-icon="exclamation-triangle">‚ö†Ô∏è</div>
        </div>
        <input type="hidden" id="zoneIcon" value="beer">
      </div>
      <div class="zone-modal__footer">
        <button id="saveZoneBtn" class="zbtn zbtn-green">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button class="zbtn zbtn-gray" onclick="cancelNewZone()">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <input id="hidden-file" type="file" accept=".csv" style="display:none">
  <input id="hidden-json" type="file" accept="application/json" style="display:none">

  <!-- –ú–æ–¥–∞–ª–∫–∞ –≤—Ö–æ–¥–∞ (–≥–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º –æ—Ç–∫–ª—é—á—ë–Ω) -->
  <div id="role-modal" class="role-modal">
    <div class="role-modal-content">
      <h3 id="login-title">–í—Ö–æ–¥</h3>
      <div id="role-choice" class="role-choice" style="display:none">
        <div class="role-choice__title muted">–ö—É–¥–∞ –≤–æ–π—Ç–∏ –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞</div>
        <div class="role-choice__buttons">
          <button id="login-target-map" class="btn outline" type="button">–ê–¥–º–∏–Ω –∫–∞—Ä—Ç—ã</button>
          <button id="login-target-cc" class="btn outline" type="button">–ö–æ–º–∞–Ω–¥–Ω—ã–π —Ü–µ–Ω—Ç—Ä</button>
        </div>
      </div>
      <div id="login-area">
        <input id="login-username" class="input" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
        <input id="login-password" class="input" type="password" placeholder="–ü–∞—Ä–æ–ª—å" style="margin-top:8px">
        <div id="login-error" style="color:#c00;font-size:0.9em;margin-top:4px;display:none"></div>
        <div style="margin-top:12px">
          <button id="login-submit" class="btn primary" title="–í–æ–π—Ç–∏">–í–æ–π—Ç–∏</button>
          <button id="login-back" class="btn" title="–ù–∞–∑–∞–¥" style="display:none">–ù–∞–∑–∞–¥</button>
        </div>
      </div>
    </div>
  </div>
  <style>
    .role-modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.55);z-index:10000;padding:16px}
    .role-modal-content{background:var(--card);color:inherit;padding:18px 18px;border-radius:16px;box-shadow: 0 16px 50px rgba(0,0,0,.45);text-align:center;max-width:520px;width:100%;border:1px solid rgba(0,0,0,0.08)}
    body.dark .role-modal-content{border-color: rgba(255,255,255,0.10)}
    .role-modal-content h3{margin:0 0 14px}
    .role-choice{margin:0 0 12px}
    .role-choice__title{margin-bottom:8px;font-size:13px}
    .role-choice__buttons{display:flex;gap:8px;justify-content:center;flex-wrap:wrap}
    .role-choice__buttons .btn{min-width:170px}
    .role-choice__buttons .btn.active{outline:2px solid rgba(109,40,217,0.55);background:rgba(109,40,217,0.10)}
    @media (max-width: 420px){
      .role-choice__buttons .btn{flex:1 1 100%;min-width:0}
    }
  </style>

  <!-- –°–∫—Ä–∏–ø—Ç—ã -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>

{# –ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Vite-–±–∞–Ω–¥–ª, –µ—Å–ª–∏ –æ–Ω —Å–æ–±—Ä–∞–Ω (manifest.json —Å—É—â–µ—Å—Ç–≤—É–µ—Ç). #}
{% set vite_main = vite_asset('src/main.js') %}
{% if vite_main %}
  {# –ü—Ä–æ–¥–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: –æ–¥–∏–Ω –±–∞–Ω–¥–ª –æ—Ç Vite —Å –∫—ç—à-–±–∞—Å—Ç–∏–Ω–≥–æ–º. #}
  <script type="module" src="{{ url_for('static', filename=vite_main) }}"></script>
{% else %}
  {# –§–æ–ª–ª–±–µ–∫: —Å—Ç–∞—Ä–∞—è —Å—Ö–µ–º–∞ ‚Äî –Ω–∞–±–æ—Ä –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏–∑ static/js. #}
  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
  <script src="{{ url_for('static', filename='js/chat.js') }}"></script>
  <!-- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ç–µ–ø–µ—Ä—å —Ç–µ–∫—Å—Ç–æ–≤–∞—è ‚Äî –±–µ–∑ Chart.js –∏ —Ç—è–∂—ë–ª—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤. -->
  <script src="{{ url_for('static', filename='js/analytics.js') }}"></script>
  <script src="{{ url_for('static', filename='js/requests.js') }}"></script>
  <script src="{{ url_for('static', filename='js/filters.js') }}"></script>
  <script src="{{ url_for('static', filename='js/offline.js') }}"></script>
  <script src="{{ url_for('static', filename='js/map_core.js') }}"></script>
  <script src="{{ url_for('static', filename='js/addresses.js') }}"></script>
  <script src="{{ url_for('static', filename='js/export.js') }}"></script>
  <script src="{{ url_for('static', filename='js/sidebar.js') }}"></script>
  <script src="{{ url_for('static', filename='js/search.js') }}"></script>
  <script src="{{ url_for('static', filename='js/ui.js') }}"></script>
  <!-- –ú–æ–¥—É–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–æ–ª–∂–µ–Ω –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –ø–æ—Å–ª–µ ui.js, —á—Ç–æ–±—ã showToast –±—ã–ª –æ–ø—Ä–µ–¥–µ–ª—ë–Ω -->
  <script src="{{ url_for('static', filename='js/notify.js') }}"></script>
  <script src="{{ url_for('static', filename='js/admin_users.js') }}"></script>
  <script src="{{ url_for('static', filename='js/zones.js') }}"></script>
{% endif %}

  <!-- –≠—Ç–∞–ø 1.1: —Å–ª–æ–π "–ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã –Ω–∞ –∫–∞—Ä—Ç–µ" -->
  <script src="{{ url_for('static', filename='js/incidents_overlay.js') }}"></script>
  <script src="{{ url_for('static', filename='js/incidents_layer_toggle.js') }}"></script>
  <script src="{{ url_for('static', filename='js/incidents_ui.js') }}"></script>

  <!-- –≠—Ç–∞–ø 2.1: —Å–ª–æ–π "–û–±—ä–µ–∫—Ç—ã" + –º–æ–¥–∞–ª–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è -->
  <script src="{{ url_for('static', filename='js/objects_overlay.js') }}"></script>
  <script src="{{ url_for('static', filename='js/objects_layer_toggle.js') }}"></script>
  <script src="{{ url_for('static', filename='js/objects_ui.js') }}"></script>
  <script src="{{ url_for('static', filename='js/objects_deeplink.js') }}"></script>

  <div id="admin-users-backdrop" class="backdrop" style="display:none">
    <div class="modal admin-modal">
      <div class="modal-head">
        <b>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã</b>
        <button id="admin-users-close" class="btn minimal" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="section muted small">
          –ó–¥–µ—Å—å —Å—É–ø–µ—Ä‚Äë–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –ª–æ–≥–∏–Ω–∞–º–∏, —Ä–æ–ª—è–º–∏ –∏ –∑–æ–Ω–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ –∞–¥–º–∏–Ω–æ–≤.
          –í—ã–±–µ—Ä–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å–ª–µ–≤–∞, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —Å–æ—Ö—Ä–∞–Ω–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è.
        </div>
        <div id="admin-users-root"></div>
      </div>
    </div>
  </div>

  <div id="zones-backdrop" class="backdrop" style="display:none">
    <div class="modal zones-modal">
      <div class="modal-head">
        <b>–ó–æ–Ω—ã</b>
        <button id="zones-close" class="btn minimal" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="section muted small">
          –ó–æ–Ω—ã –ø–æ–º–æ–≥–∞—é—Ç –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å –∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤.
          –°–æ–∑–¥–∞–≤–∞–π –∑–æ–Ω—ã, –∑–∞–¥–∞–≤–∞–π –∏–º –∏–º–µ–Ω–∞ –∏ —Ü–≤–µ—Ç–∞, –∞ –∑–∞—Ç–µ–º –ø—Ä–∏–≤—è–∑—ã–≤–∞–π –∫ –Ω–∏–º –∞–¥–º–∏–Ω–æ–≤.
        </div>
        <div id="zones-root"></div>
      </div>
    </div>
  </div>

  <div id="help-backdrop" class="backdrop" style="display:none">
    <div class="modal help-modal">
      <div class="modal-head">
        <b>–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–∏—Å—Ç–µ–º–æ–π</b>
        <button id="help-close" class="btn minimal" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
      <div class="modal-body help-body">
        <div class="section">
          <h4>–ö–∞—Ä—Ç–∞ –∏ –∞–¥—Ä–µ—Å–∞</h4>
          <ul>
            <li>–°–ª–µ–≤–∞ ‚Äî —Å–ø–∏—Å–æ–∫ –∞–¥—Ä–µ—Å–æ–≤, —Å–ø—Ä–∞–≤–∞ ‚Äî –∫–∞—Ä—Ç–∞. –ö–ª–∏–∫ –ø–æ —Å—Ç—Ä–æ–∫–µ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç –º–µ—Ç–∫—É –Ω–∞ –∫–∞—Ä—Ç–µ.</li>
            <li>–ö–Ω–æ–ø–∫–∞ <b>–î–æ–±–∞–≤–∏—Ç—å</b> –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –º–µ—Ç–∫–∏.</li>
            <li>–ß–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É <b>–î–∞–Ω–Ω—ã–µ</b> –º–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å/—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å CSV –∏ JSON.</li>
          </ul>
        </div>
        <div class="section">
          <h4>–ó–∞—è–≤–∫–∏ –∏ —á–∞—Ç</h4>
          <ul>
            <li>–ö–æ–ª–æ–∫–æ–ª—å—á–∏–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ –∑–∞—è–≤–∫–∏ —Å –±–æ—Ç–∞. –ù–∞–∂–º–∏, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å —Å–ø–∏—Å–æ–∫.</li>
            <li>–ß–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É <b>–ß–∞—Ç</b> –º–æ–∂–Ω–æ –æ–±—â–∞—Ç—å—Å—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –ø—Ä—è–º–æ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞.</li>
          </ul>
        </div>
        <div class="section">
          <h4>–ê–¥–º–∏–Ω—ã –∏ –∑–æ–Ω—ã</h4>
          <ul>
            <li>–ö–Ω–æ–ø–∫–∞ <b>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã</b> –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ —Å—É–ø–µ—Ä‚Äë–∞–¥–º–∏–Ω—É –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–æ—Å—Ç—É–ø–∞–º–∏.</li>
            <li>–ö–Ω–æ–ø–∫–∞ <b>–ó–æ–Ω—ã</b> –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ä–µ–¥–∞–∫—Ç–æ—Ä –∑–æ–Ω ‚Äî –∑–∞–¥–∞–π –Ω–∞–∑–≤–∞–Ω–∏—è, —Ü–≤–µ—Ç–∞ –∏ —Å–≤—è–∂–∏ –∏—Ö —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏.</li>
          </ul>
        </div>
        <div class="section">
          <h4>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h4>
          <ul>
            <li>–í —Ä–∞–∑–¥–µ–ª–µ <b>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</b> –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–∏–Ω–∞–º–∏–∫—É –∑–∞—è–≤–æ–∫ –∏ –∞–¥—Ä–µ—Å–æ–≤ –ø–æ –¥–Ω—è–º.</li>
            <li>–§–∏–ª—å—Ç—Ä—ã –∏ –∑–æ–Ω–∞ –¥–æ—Å—Ç—É–ø–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç –ø—Ä–∞–≤–∞ —Ç–µ–∫—É—â–µ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div id="toast-container"></div>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function () {
        navigator.serviceWorker.register('/sw.js', { scope: '/' })
          .then(reg => console.log('SW registered:', reg.scope))
          .catch(err => console.warn('SW registration failed', err));
      });
    }
  </script>




  <script src="{{ url_for('static', filename='js/sos.js') }}"></script>
</body>
</html>